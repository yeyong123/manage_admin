webpackJsonp([23,38],{194:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{addons:[],page:{next_page:1},addon:{content:"",serial_number:"",nickname:"",title:"",pictures:[]},dialogVisible:!1,images:[],files:[],type:"new"}},created:function(){this.fetchResource(this.page.next_page)},methods:{fetchResource:function(t){var e=this;this.$http.get("addons.json?page="+t).then(function(t){e.addons=t.body.klass,e.page=t.body.page})},handlePage:function(t){this.fetchResource(t)},edit_addon:function(t){var e=this;e.type="edit",e.dialogVisible=!0,e.images=[],e.addons.forEach(function(a,n){if(a.id==t)return void(e.addon=a)})},uploadImage:function(t){var e=this,a=t.target.files,n=new FileReader;a.length&&(e.files.push(a[0]),n.onload=function(){e.images.push(n.result)},n.readAsDataURL(a[0]))},new_addon:function(){this.type,this.dialogVisible=!0,this.images=[],this.addon={}},PostAddon:function(t,e){var a=this,n=this,i=new FormData;for(var o in n.addon)n.addon[o]&&i.append(o,n.addon[o]);if(n.files.length>0){n.files.forEach(function(t,e){i.append("pictures_attributes[][image]",t)})}"new"==t?this.$http.post("addons.json",i).then(function(t){200==t.body.code&&(a.addons.unshift(t.body.addon),a.dialogVisible=!1)}):n.$http.put("addons/"+e+".json",i).then(function(t){200==t.body.code&&(n.dialogVisible=!1)})}}}},317:function(t,e,a){e=t.exports=a(7)(),e.push([t.i,"img[data-v-11f0052a]{width:100px;height:100px;margin-right:20px;float:left}.cu-footer[data-v-11f0052a]{clear:both}",""])},611:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-menu"}),t._v(" "),a("router-link",{attrs:{to:"/dashboard"}},[t._v("\n          主页\n          ")])],1),t._v(" "),a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-setting"}),t._v("插件")])],1)],1),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.new_addon}},[t._v("添加插件")]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.addons,border:""}},[a("el-table-column",{attrs:{prop:"title",label:"插件名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"content",label:"插件介绍"}}),t._v(" "),a("el-table-column",{attrs:{prop:"serial_number",label:"编号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"nickname",label:"别名"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([["default",function(e){return[a("span",{on:{click:function(a){t.edit_addon(e.row.id)}}},[t._v("编辑")])]}]])})],1),t._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{layout:"prev, pager, next","current-page":t.page.current_page,"page-size":25,total:t.page.total_count},on:{"current-change":t.handlePage}})],1),t._v(" "),a("el-dialog",{attrs:{title:"操作"},model:{value:t.dialogVisible,callback:function(e){t.dialogVisible=e}}},[a("el-form",{ref:"addon",attrs:{inline:!0,model:t.addon,"label-width":"80px",enctype:"multipart/form-data"}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{model:{value:t.addon.title,callback:function(e){t.addon.title=e}}})],1),t._v(" "),a("el-form-item",{attrs:{label:"介绍"}},[a("el-input",{model:{value:t.addon.content,callback:function(e){t.addon.content=e}}})],1),t._v(" "),a("el-form-item",{attrs:{label:"编号"}},[a("el-input",{model:{value:t.addon.serial_number,callback:function(e){t.addon.serial_number=e}}})],1),t._v(" "),a("el-form-item",{attrs:{label:"别名"}},[a("el-input",{model:{value:t.addon.nickname,callback:function(e){t.addon.nickname=e}}})],1),t._v(" "),a("el-form-item",{attrs:{label:"图片"}},[a("input",{attrs:{type:"file"},on:{change:t.uploadImage}})]),t._v(" "),t._l(t.images,function(e){return t.images.length>0?a("div",[a("img",{attrs:{src:e}})]):t._e()}),t._v(" "),a("div",{staticClass:"cu-footer"},[a("br"),t._v(" "),a("hr"),t._v(" "),t.addon.pictures&&t.addon.pictures.length>0?a("p",[t._v("旧的图片")]):t._e(),t._v(" "),t._l(t.addon.pictures,function(t){return a("div",[a("img",{attrs:{src:t.image.url}})])})],2)],2),t._v(" "),a("span",{staticClass:"dialog-footer",slot:"footer"},[a("div",{staticClass:"cu-footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.PostAddon(t.type,t.addon.id)}}},[t._v("提交")]),t._v(" "),a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")])],1)])],1)],1)},staticRenderFns:[]}},651:function(t,e,a){var n=a(317);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(30)("0fe4d776",n,!0)},82:function(t,e,a){a(651);var n=a(31)(a(194),a(611),"data-v-11f0052a",null);t.exports=n.exports}});