webpackJsonp([9,41],{116:function(e,t,a){a(688);var l=a(31)(a(230),a(655),"data-v-da4efb00",null);e.exports=l.exports},230:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{users:[],page:{},text_q:"",dialogVisible:!1,type:"new",edit_id:"",user:{real_name:"",password:"",tel:"",email:"",role:"",headimg:"",audit:!0,locked:!1,address:"",company_id:"",brand_name:"",region:"",user_type:"",amount:0},image:""}},created:function(){this.fetchResource(this.page.next_page)},methods:{fetchResource:function(e){var t=this;t.$http.get("users.json?page="+e+"&q="+this.text_q).then(function(e){t.users=e.body.klass,t.page=e.body.page},function(e){t.$message.error("加载失败")})},handlePage:function(e){this.fetchResource(e)},rowClick:function(e){this.$router.push("/users/"+e.id)},handleCompany:function(e){this.$router.push("/companies/"+e)},addUser:function(){this.dialogVisible=!0},editUser:function(e){var t=this;t.dialogVisible=!0,t.users.forEach(function(a,l){if(e===a.id){for(var r in t.user)t.user[r]=a[r];return void(t.edit_id=e)}}),t.type="edit"},userSubmit:function(e,t){var a=this,l=new FormData;for(var r in this.user)this.user[r]&&l.append(r,this.user[r]);a.image&&l.append("headimg",a.image),"edit"==e?a.$http.put("users/"+t+".json",l).then(function(e){a.dialogVisible=!1},function(e){a.$message.error("更新失败")}):a.$http.post("users.json",l).then(function(e){var t=e.body;if(t.code>200)return void a.$message.error(t.msg);a.users.unshift(e.body.klass),a.dialogVisible=!1},function(e){a.$message.error("创建失败")})},searchQuery:function(e){this.fetchResource(1)},uploadImage:function(e){var t=e.target.files;t.length&&(this.image=t[0])},defaultImg:function(e,t){e.target.src="https://images.chuanggj.com/chuang.png"}}}},347:function(e,t,a){t=e.exports=a(7)(),t.push([e.i,".headimg[data-v-da4efb00]{width:80px;height:80px}.search[data-v-da4efb00]{width:200px;float:right}.user-header[data-v-da4efb00]{margin-bottom:20px}",""])},655:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-menu"}),e._v(" "),a("router-link",{attrs:{to:"/dashboard"}},[e._v("\n         主页\n         ")])],1),e._v(" "),a("el-breadcrumb-item",[e._v("用户列表")])],1)],1),e._v(" "),a("div",{staticClass:"user-header"},[a("el-button",{attrs:{type:"text"},on:{click:e.addUser}},[e._v("创建用户")]),e._v(" "),a("el-input",{staticClass:"search",attrs:{icon:"search","on-icon-click":e.searchQuery},model:{value:e.text_q,callback:function(t){e.text_q=t}}})],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.users,border:""}},[a("el-table-column",{attrs:{label:"id",width:"120"},scopedSlots:e._u([["default",function(t){return[a("span",{on:{click:function(a){e.rowClick(t.row)}}},[e._v(e._s(t.row.id))])]}]])}),e._v(" "),a("el-table-column",{attrs:{label:"头像",width:"150"},scopedSlots:e._u([["default",function(t){return[a("img",{staticClass:"headimg",attrs:{src:t.row.headimg.url},on:{error:e.defaultImg}})]}]])}),e._v(" "),a("el-table-column",{attrs:{prop:"real_name",label:"姓名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"tel",label:"手机"}}),e._v(" "),a("el-table-column",{attrs:{label:"角色"},scopedSlots:e._u([["default",function(t){return[1==t.row.role?a("span",[e._v("品牌商")]):2==t.row.role?a("span",[e._v("服务商")]):a("span",[e._v("普通用户")])]}]])}),e._v(" "),a("el-table-column",{attrs:{label:"所属品牌"},scopedSlots:e._u([["default",function(t){return[a("span",{on:{click:function(a){e.handleCompany(t.row.company_id)}}},[e._v(e._s(t.row.company_id))])]}]])}),e._v(" "),a("el-table-column",{attrs:{label:"加入时间",width:"220"},scopedSlots:e._u([["default",function(t){return[e._v("\n                    "+e._s(e._f("date")(1e3*t.row.created_at,"%Y-%m-%d %T"))+"\n                  ")]}]])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([["default",function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){e.rowClick(t.row)}}},[e._v("查看")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.editUser(t.row.id)}}},[e._v("编辑")])]}]])})],1),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{layout:"prev, pager, next","current-page":e.page.current_page,"page-size":25,total:e.page.total_count},on:{"current-change":e.handlePage}})],1),e._v(" "),a("el-dialog",{attrs:{title:"操作用户"},model:{value:e.dialogVisible,callback:function(t){e.dialogVisible=t}}},[a("el-form",{ref:"user",attrs:{inline:!0,model:e.user,"label-width":"80px",enctype:"multipart/form-data"}},[a("el-form-item",{attrs:{label:"真实姓名"}},[a("el-input",{model:{value:e.user.real_name,callback:function(t){e.user.real_name=t}}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机"}},[a("el-input",{model:{value:e.user.tel,callback:function(t){e.user.tel=t}}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码"}},[a("el-input",{attrs:{type:"password"},model:{value:e.user.password,callback:function(t){e.user.password=t}}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱"}},[a("el-input",{model:{value:e.user.email,callback:function(t){e.user.email=t}}})],1),e._v(" "),a("el-form-item",{attrs:{label:"品牌商"}},[a("el-input",{model:{value:e.user.company_id,callback:function(t){e.user.company_id=t}}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色"}},[a("el-select",{attrs:{placeholder:"选择角色"},model:{value:e.user.role,callback:function(t){e.user.role=t}}},[a("el-option",{attrs:{label:"普通用户",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"服务商",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"品牌商",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"权限"}},[a("el-select",{attrs:{placeholder:"选择权限"},model:{value:e.user.user_type,callback:function(t){e.user.user_type=t}}},[a("el-option",{attrs:{label:"普通用户",value:"user"}}),e._v(" "),a("el-option",{attrs:{label:"技术",value:"tech"}}),e._v(" "),a("el-option",{attrs:{label:"财务",value:"finance"}}),e._v(" "),a("el-option",{attrs:{label:"客服",value:"server"}}),e._v(" "),a("el-option",{attrs:{label:"商务",value:"business"}}),e._v(" "),a("el-option",{attrs:{label:"出纳",value:"cashier"}}),e._v(" "),a("el-option",{attrs:{label:"超级用户",value:"super"}}),e._v(" "),a("el-option",{attrs:{label:"管理员",value:"manager"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"审核",prop:"audit"}},[a("el-switch",{attrs:{"on-text":"","off-text":""},model:{value:e.user.audit,callback:function(t){e.user.audit=t}}})],1),e._v(" "),a("el-form-item",{attrs:{label:"头像"}},[a("input",{attrs:{type:"file"},on:{change:e.uploadImage}})])],1),e._v(" "),a("span",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.userSubmit(e.type,e.edit_id)}}},[e._v("提交")]),e._v(" "),a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")])],1)],1)],1)},staticRenderFns:[]}},688:function(e,t,a){var l=a(347);"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);a(30)("6d856e80",l,!0)}});